@model IEnumerable<MileageExpenseTracker.Models.Wik>
@{
    ViewData["Title"] = "Wik Management";
}

<div class="container" style="max-width: 1200px; margin: 2rem auto; padding: 1.5rem;">
    <!-- Header Card -->
    <div style="
        background: white;
        padding: 1.5rem;
        border-radius: 0.5rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        margin-bottom: 1.5rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 1rem;
    ">
        <div>
            <h1 style="font-size: 1.5rem; font-weight: 600; color: #111827; margin-bottom: 0.5rem;">
                Wik Management
            </h1>
            <p style="color: #6b7280; font-size: 0.875rem; margin: 0;">
                Manage all Wik entries in the system.
            </p>
        </div>
        <a asp-action="Create"
           style="
               padding: 0.625rem 1.25rem;
               background-color: #3b82f6;
               color: white;
               border: none;
               border-radius: 0.375rem;
               font-weight: 500;
               text-decoration: none;
               display: inline-flex;
               align-items: center;
               gap: 0.5rem;
           "
           onmouseover="this.style.backgroundColor='#2563eb'"
           onmouseout="this.style.backgroundColor='#3b82f6'">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z" />
            </svg>
            Create New
        </a>
    </div>

    <!-- Table Card -->
    <div style="
        background: white;
        padding: 1.5rem;
        border-radius: 0.5rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    ">
        <table id="wikTable" class="table table-hover" style="width: 100%;">
            <thead style="background-color: #f9fafb; border-bottom: 2px solid #e5e7eb;">
                <tr>
                    <th style="padding: 0.75rem; font-weight: 600; color: #374151; font-size: 0.875rem;">
                        @Html.DisplayNameFor(model => model.Name)
                    </th>
                    <th style="padding: 0.75rem; font-weight: 600; color: #374151; font-size: 0.875rem; text-align: center; width: 200px;">
                        Actions
                    </th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    <tr>
                        <td style="padding: 0.75rem; color: #111827;">
                            @Html.DisplayFor(modelItem => item.Name)
                        </td>
                        <td style="padding: 0.75rem; text-align: center;">
                            <div style="display: inline-flex; gap: 0.5rem;">
                                <a asp-action="Edit" asp-route-id="@item.Id"
                                   style="
                                       padding: 0.375rem 0.75rem;
                                       background-color: #3b82f6;
                                       color: white;
                                       border-radius: 0.25rem;
                                       text-decoration: none;
                                       font-size: 0.875rem;
                                       font-weight: 500;
                                       "
                                   onmouseover="this.style.backgroundColor='#2563eb'"
                                   onmouseout="this.style.backgroundColor='#3b82f6'">
                                    Edit
                                </a>
                                <a asp-action="Details" asp-route-id="@item.Id"
                                   style="
                                       padding: 0.375rem 0.75rem;
                                       background-color: #6b7280;
                                       color: white;
                                       border-radius: 0.25rem;
                                       text-decoration: none;
                                       font-size: 0.875rem;
                                       font-weight: 500;
                                       "
                                   onmouseover="this.style.backgroundColor='#4b5563'"
                                   onmouseout="this.style.backgroundColor='#6b7280'">
                                    Details
                                </a>
                                <a href="javascript:void(0);"
                                   onclick="confirmDelete(@item.Id)"
                                   style="
                                       padding: 0.375rem 0.75rem;
                                       background-color: #dc2626;
                                       color: white;
                                       border-radius: 0.25rem;
                                       text-decoration: none;
                                       font-size: 0.875rem;
                                       font-weight: 500;
                                       "
                                   onmouseover="this.style.backgroundColor='#b91c1c'"
                                   onmouseout="this.style.backgroundColor='#dc2626'">
                                    Delete
                                </a>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<!-- Hidden form for delete -->
<form id="deleteForm" method="post" style="display: none;">
    @Html.AntiForgeryToken()
</form>

<style>
    /* DataTables custom styling */
    .dataTables_wrapper .dataTables_length select,
    .dataTables_wrapper .dataTables_filter input {
        padding: 0.375rem 0.75rem;
        border: 1px solid #d1d5db;
        border-radius: 0.375rem;
        font-size: 0.875rem;
    }

        .dataTables_wrapper .dataTables_filter input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

    .dataTables_wrapper .dataTables_length,
    .dataTables_wrapper .dataTables_filter,
    .dataTables_wrapper .dataTables_info,
    .dataTables_wrapper .dataTables_paginate {
        color: #374151;
        font-size: 0.875rem;
    }

        .dataTables_wrapper .dataTables_paginate .paginate_button {
            padding: 0.375rem 0.75rem;
            margin: 0 0.125rem;
            border-radius: 0.25rem;
            border: 1px solid #d1d5db;
            background: white;
            color: #374151 !important;
        }

            .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
                background: #f9fafb !important;
                border-color: #3b82f6 !important;
                color: #3b82f6 !important;
            }

            .dataTables_wrapper .dataTables_paginate .paginate_button.current {
                background: #3b82f6 !important;
                border-color: #3b82f6 !important;
                color: white !important;
            }

    table.dataTable tbody tr:hover {
        background-color: #f9fafb;
    }
</style>

@section Scripts {
    <!-- DataTables CSS -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">

    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>

    <script>
        $(document).ready(function () {
            $('#wikTable').DataTable({
                "pageLength": 10,
                "ordering": true,
                "searching": true,
                "lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]],
                "language": {
                    "search": "Search:",
                    "lengthMenu": "Show _MENU_ entries",
                    "info": "Showing _START_ to _END_ of _TOTAL_ entries",
                    "infoEmpty": "Showing 0 to 0 of 0 entries",
                    "infoFiltered": "(filtered from _MAX_ total entries)",
                    "paginate": {
                        "first": "First",
                        "last": "Last",
                        "next": "Next",
                        "previous": "Previous"
                    }
                }
            });
        });

        function confirmDelete(id) {
            Swal.fire({
                title: 'Are you sure?',
                text: "You won't be able to revert this!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#dc2626',
                cancelButtonColor: '#6b7280',
                confirmButtonText: 'Yes, delete it!',
                cancelButtonText: 'Cancel'
            }).then((result) => {
                if (result.isConfirmed) {
                    var form = $('#deleteForm');
                    form.attr('action', '/Wik/Delete/' + id);
                    form.submit();
                }
            });
        }
    </script>

    @if (TempData["SuccessMessage"] != null)
    {
        <script>
            Swal.fire({
                icon: 'success',
                title: 'Success!',
                text: '@TempData["SuccessMessage"]',
                showConfirmButton: false,
                timer: 2000,
                timerProgressBar: true
            });
        </script>
    }

    @if (TempData["ErrorMessage"] != null)
    {
        <script>
            Swal.fire({
                icon: 'error',
                title: 'Error!',
                text: '@TempData["ErrorMessage"]',
                confirmButtonColor: '#3b82f6'
            });
        </script>
    }
}